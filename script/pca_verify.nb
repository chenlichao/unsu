(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     14038,        433]
NotebookOptionsPosition[     12687,        383]
NotebookOutlinePosition[     13025,        398]
CellTagsIndexPosition[     12982,        395]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"raw", " ", "=", " ", 
   RowBox[{"ReadList", "[", 
    RowBox[{"\"\<~/data/r1005mat.txt\>\"", ",", "Number"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.571800777316728*^9, 3.571800801963832*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"Partition", "[", 
    RowBox[{"raw", ",", "4480"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5717169450526114`*^9, 3.57171699199463*^9}, {
  3.571800938963192*^9, 3.5718009460326977`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PrincipalComponents", "[", "data", "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.571716969610834*^9, 3.571717002644421*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"3.3482018448264883`", "0.19885775393603883`"},
     {"2.035435474087366`", 
      RowBox[{"-", "0.327112260281909`"}]},
     {
      RowBox[{"-", "2.035435474087366`"}], "0.3271122602819089`"},
     {
      RowBox[{"-", "3.348201844826489`"}], 
      RowBox[{"-", "0.1988577539360386`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.5717169856523333`*^9, 3.571717003052003*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"mean", " ", "=", " ", 
   RowBox[{"Mean", "[", "data", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5717173368385267`*^9, 3.571717354526278*^9}, 
   3.571800963319339*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nordata", " ", "=", " ", 
   RowBox[{"ParallelMap", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Subtract", "[", 
       RowBox[{"#", ",", "mean"}], "]"}], "&"}], ",", "data"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.571717359007485*^9, 3.571717386383257*^9}, {
  3.571801339084647*^9, 3.571801365580677*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"corr", " ", "=", " ", 
   RowBox[{"Covariance", "[", "nordata", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.571802656907419*^9, 3.571802664630274*^9}, {
  3.571803017778472*^9, 3.571803020078884*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cor", " ", "=", " ", 
   RowBox[{
    RowBox[{"Transpose", "[", "nordata", "]"}], ".", "nordata"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5717174009000483`*^9, 3.571717412469564*^9}, 
   3.571801925906432*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"evals", ",", "evecs"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", "cor", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.571802055072256*^9, 3.5718020842540894`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"correvals", ",", "corrvecs"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", "corr", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.571802686371608*^9, 3.571802694618887*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "/@", 
  RowBox[{"{", 
   RowBox[{"evals", ",", "evecs"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.571802369870245*^9, 3.571802379011671*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "4480", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4480", ",", "4480"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.5718023798668003`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Sort", "[", 
   RowBox[{"correvals", ",", "Greater"}], "]"}], "[", 
  RowBox[{"[", 
   RowBox[{"1", ";;", "10"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.571802261043564*^9, 3.571802287703776*^9}, {
   3.571802560935988*^9, 3.571802566249086*^9}, 3.571803622738442*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4.157105040511262`", ",", "2.0574584522545387`", ",", 
   "1.9225947633635234`", ",", "1.0421833091001633`", ",", 
   "0.9532938430244297`", ",", "0.8704282030329747`", ",", 
   "0.7491755908218081`", ",", "0.6491885316535609`", ",", 
   "0.5869979758062235`", ",", "0.552180629612792`"}], "}"}]], "Output",
 CellChangeTimes->{{3.5718022680814533`*^9, 3.571802288413162*^9}, 
   3.571802566571146*^9, 3.571803623632351*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"SingularValueDecomposition", "[", 
   RowBox[{"nordata", "//", "Transpose"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5717190118964987`*^9, 3.571719053217433*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.39339817826058837`", 
        RowBox[{"-", "0.9193681924785359`"}]},
       {"0.9193681924785359`", "0.39339817826058837`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"5.541381265149109`", "0.`", "0.`", "0.`"},
       {"0.`", "0.5413812651491099`", "0.`", "0.`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", "0.6042179169089161`"}], "0.36731554403026556`", 
        "0.03934466291663154`", "0.7060113295832982`"},
       {
        RowBox[{"-", "0.36731554403026534`"}], 
        RowBox[{"-", "0.6042179169089161`"}], "0.7060113295832983`", 
        RowBox[{"-", "0.03934466291663136`"}]},
       {"0.3673155440302654`", "0.6042179169089162`", "0.7060113295832984`", 
        RowBox[{"-", "0.039344662916631704`"}]},
       {"0.6042179169089161`", 
        RowBox[{"-", "0.3673155440302652`"}], "0.03934466291663154`", 
        "0.7060113295832984`"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.5717190341130667`*^9, 3.571719053630316*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"nordata", ".", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"-", "0.39339817826058837`"}], 
       RowBox[{"-", "0.9193681924785359`"}]},
      {
       RowBox[{"-", "0.9193681924785359`"}], "0.39339817826058837`"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.571719286742979*^9, 3.571719300357884*^9}, {
  3.571720365362361*^9, 3.5717203661089773`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"3.34820184482649`", "0.19885775393603877`"},
     {"2.035435474087366`", 
      RowBox[{"-", "0.3271122602819088`"}]},
     {
      RowBox[{"-", "2.035435474087366`"}], "0.3271122602819088`"},
     {
      RowBox[{"-", "3.34820184482649`"}], 
      RowBox[{"-", "0.19885775393603877`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.5717192950857277`*^9, 3.571719300684083*^9}, 
   3.571720367243436*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.571802257330873*^9, 3.571802258273015*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cor", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", 
      RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "/", 
   RowBox[{
    RowBox[{"Dimensions", "[", "data", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.5718037151622057`*^9, 3.571803858955409*^9}, {
  3.57180389103962*^9, 3.571803897216237*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.018313768919995695`", "0.01317834828681796`", 
      "0.009073199974673573`"},
     {"0.01317834828681796`", "0.01795431914459849`", "0.013082925123410999`"},
     {"0.009073199974673573`", "0.013082925123410999`", 
      "0.017945157479504828`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.5718037422259827`*^9, {3.571803784608264*^9, 3.571803859577347*^9}, 
   3.571803897592396*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"corr", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"1", ";;", "3"}], ",", 
     RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "//", "MatrixForm"}]], "Input",\

 CellChangeTimes->{3.571803824802103*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.018313959329420836`", "0.013178485302946786`", 
      "0.00907329430931321`"},
     {"0.013178485302946786`", "0.01795450581680136`", 
      "0.013083061147419101`"},
     {"0.00907329430931321`", "0.013083061147419101`", 
      "0.01794534405645328`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.571803825674674*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4.157105040511262`", ",", "2.0574584522545387`", ",", 
   "1.9225947633635234`", ",", "1.0421833091001633`", ",", 
   "0.9532938430244297`", ",", "0.8704282030329747`", ",", 
   "0.7491755908218081`", ",", "0.6491885316535609`", ",", 
   "0.5869979758062235`", ",", "0.552180629612792`"}], "}"}]], "Input"]
},
WindowSize->{740, 867},
WindowMargins->{{775, Automatic}, {Automatic, 154}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 240, 6, 32, "Input"],
Cell[800, 28, 265, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[1090, 38, 177, 4, 32, "Input"],
Cell[1270, 44, 916, 24, 94, "Output"]
}, Open  ]],
Cell[2201, 71, 209, 5, 32, "Input"],
Cell[2413, 78, 359, 10, 32, "Input"],
Cell[2775, 90, 239, 5, 32, "Input"],
Cell[3017, 97, 250, 7, 32, "Input"],
Cell[3270, 106, 233, 6, 32, "Input"],
Cell[3506, 114, 239, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[3770, 124, 180, 4, 32, "Input"],
Cell[3953, 130, 199, 6, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4189, 141, 310, 7, 32, "Input"],
Cell[4502, 150, 466, 9, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5005, 164, 219, 4, 32, "Input"],
Cell[5227, 170, 2624, 65, 121, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7888, 240, 860, 22, 70, "Input"],
Cell[8751, 264, 941, 25, 94, "Output"]
}, Open  ]],
Cell[9707, 292, 92, 1, 32, "Input"],
Cell[CellGroupData[{
Cell[9824, 297, 432, 12, 32, "Input"],
Cell[10259, 311, 927, 23, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11223, 339, 237, 8, 32, "Input"],
Cell[11463, 349, 856, 22, 77, "Output"]
}, Open  ]],
Cell[12334, 374, 349, 7, 99, "Input"]
}
]
*)

(* End of internal cache information *)

